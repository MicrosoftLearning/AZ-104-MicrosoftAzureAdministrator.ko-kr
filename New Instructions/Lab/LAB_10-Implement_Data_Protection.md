---
lab:
  title: '랩 10: 데이터 보호 구현'
  module: Administer Data Protection
---

# 랩 10 – 데이터 보호 구현

## 랩 소개    

이 랩에서는 Azure 가상 머신의 백업 및 복구에 대해 알아봅니다. Azure 가상 머신에 대한 Recovery Service 자격 증명 모음 및 백업 정책을 만드는 방법을 알아봅니다. 가상 머신용 Azure Site Recovery를 사용하여 재해 복구에 대해 알아봅니다. 

이 랩에는 Azure 구독이 필요합니다. 구독 유형은 이 랩의 기능 가용성에 영향을 줄 수 있습니다. 지역을 변경할 수 있지만 단계는 미국 동부 및 미국 서부를 사용하여 작성됩니다.

## 예상 소요 시간: 40분

## 랩 시나리오

조직에서 Azure 가상 머신에 호스트된 파일의 백업 및 복원에 대해 Azure Recovery Services를 평가하고 있습니다. 실수로 또는 악의적인 데이터 손실로부터 Recovery Services 자격 증명 모음에 저장된 데이터를 보호하는 방법을 식별하려고 합니다.

## 대화형 랩 시뮬레이션

이 항목에 유용할 수 있는 대화형 랩 시뮬레이션이 있습니다. 시뮬레이션을 사용하면 비슷한 시나리오를 원하는 속도로 클릭할 수 있습니다. 대화형 시뮬레이션과 이 랩 사이에는 차이점이 있지만, 대부분의 핵심 개념은 동일합니다. Azure 구독은 필요하지 않습니다.

+ **[가상 머신 및 온-프레미스 파일을](https://mslabs.cloudguides.com/guides/AZ-104%20Exam%20Guide%20-%20Microsoft%20Azure%20Administrator%20Exercise%2016)** 백업합니다. 복구 서비스 자격 증명 모음을 만들고 Azure 가상 머신 백업을 구현합니다. Microsoft Azure Recovery Services 에이전트를 사용하여 온-프레미스 파일 및 폴더 백업을 구현합니다. 온-프레미스 백업은 이 랩의 범위를 벗어나지만 이러한 단계를 보는 데 도움이 될 수 있습니다. 

## 작업

+ 작업 1: 랩 환경 프로비전
+ 작업 2: Recovery Services 자격 증명 모음 만들기
+ 작업 3: Azure 가상 머신 수준 백업 구현
+ 작업 4: Azure Backup 모니터링
+ 작업 5: 가상 머신에 대한 Azure Site Recovery 구현

## 예상 소요 시간: 40분

## 아키텍처 다이어그램

![아키텍처 작업의 다이어그램.](../media/az104-lab10-architecture-diagram.png)

## 작업 1: 랩 환경 프로비전

이 작업에서는 템플릿을 사용하여 가상 머신을 배포합니다. VM은 다른 백업 시나리오를 테스트하는 데 사용됩니다.

1. 필요한 경우 Allfiles\\Labs\\10 az104-10-vms-edge-template.json**\\ 및 **\\Allfiles\\Labs\\10\\az104-10-vms-edge-parameters.json** 랩 파일을 컴퓨터에 다운로드**\\합니다.

1. **Azure Portal** - `https://portal.azure.com`에 로그인합니다.

1. Azure Portal에서 검색하여 선택합니다 `Deploy a custom template`.

1. 사용자 지정 배포 페이지에서 편집기**에서 고유한 템플릿 빌드를 선택합니다**.

1. 템플릿 편집 페이지에서 파일** 로드를 선택합니다**.

1. Allfiles\\Labs\\10 az104-10-vms-edge-template.json\\** 파일을 찾아 선택하고 열기**를 선택합니다**.**\\

1. **저장**을 선택합니다.

1. 사용자 지정 배포 페이지에서 매개 변수** 편집을 선택합니다**.

1. 매개 변수 편집 페이지에서 파일** 로드를 선택합니다**. Allfiles\\Labs\\10 az104-10-vms-edge-parameters.json\\** 파일을 찾아 선택하고 열기**를 선택합니다**.**\\

1. **저장**을 선택합니다.

1. 다음 정보를 사용하여 사용자 지정 배포 필드를 완료하고 다른 모든 필드에 기본값을 남깁니다.

    | 설정       | 값         | 
    | ---           | ---           |
    | Subscription  | Azure 구독 |
    | Resource group| `az104-rg10` (필요한 ** 경우새로** 만들기)
    | 지역        | **미국 동부**   |
    | 사용자 이름      | `Student`   |
    | 암호      | 복잡한 암호 제공 |

1. **검토 + 만들기**, **만들기**를 차례로 선택합니다.

## 작업 2: Recovery Services 자격 증명 모음 만들기

이 작업에서는 Recovery Services 자격 증명 모음을 만듭니다. Recovery Services 자격 증명 모음은 Azure VM에 대한 백업 서비스를 제공합니다.

1. Azure Portal에서 검색하여 선택하고 `Recovery Services vaults` Recovery Services** 자격 증명 모음 블레이드에서 **+ 만들기**를 클릭합니다**.

1. **Recovery Services 자격 증명 모음 만들기** 블레이드에서 다음 설정을 지정합니다.

    | 설정 | 값 |
    | --- | --- |
    | 구독 | Azure 구독의 이름 |
    | Resource group | **az104-rg10vault** (필요한 경우 새로 만들기 선택) |
    | 자격 증명 모음 이름 | `az104-vault1` |
    | 지역 | **미국** 서부(또는 이전 작업에서 VM을 배포하는 데 사용하지 않은 지역) |

    >**참고**: 이전 작업에서 가상 머신을 배포한 다른 지역을 지정해야 합니다.

    ![복구 서비스 자격 증명 모음의 스크린샷.](../media/az104-lab10-create-rsv.png)

1. **검토 + 만들기**를 클릭하고, 유효성 검사를 통과했는지 확인하고, **만들기**를 클릭합니다.

    >**참고**: 배포가 완료될 때까지 기다립니다. 배포에 걸리는 시간은 1분 미만입니다.

1. 배포가 완료되면 **리소스로 이동**을 클릭합니다.

1. **az104-vault1** Recovery Services 자격 증명 모음 블레이드의 **설정** 섹션에서 속성을** 클릭합니다**.

1. **az104-vault1 - 속성** 블레이드에서 백업 구성** 레이블 아래**의 **업데이트** 링크를 클릭합니다.

1. Backup 구성 블레이드에서 **스토리지 복제본(replica)tion 유형에 대한 **선택 항목을 검토합니다**.** **지역 중복**의 기본 설정을 그대로 놔두고 블레이드를 닫습니다.

    >**참고**: 이 설정은 기존 백업 항목이 없는 경우에만 구성할 수 있습니다.

1. **az104-vault1 - 속성** 블레이드로 돌아가서 보안 설정** 레이블 아래**의 **업데이트** 링크를 클릭합니다.

1. **보안 설정** 블레이드에서 **일시 삭제(Azure에서 실행되는 워크로드의 경우)** 가 **사용**으로 설정되어 있는지 확인합니다.

1. **보안 설정** 블레이드를 닫고 **az104-vault1** Recovery Services 자격 증명 모음 블레이드에서 개요**를 클릭합니다**.

## 작업 3: Azure 가상 머신 수준 백업 구현

이 작업에서는 Azure 가상 머신 수준의 백업을 구현합니다. VM 백업의 일부로 백업에 적용되는 백업 및 보존 정책을 정의해야 합니다. VM에 다른 백업 및 보존 정책이 할당되어 있을 수 있습니다.

   >**참고**: 이 작업을 시작하기 전에 이 랩의 첫 번째 작업에서 시작한 배포가 성공적으로 완료되었는지 확인합니다.

1. **az104-vault1** Recovery Services 자격 증명 모음 블레이드에서 개요**를 클릭한 **다음 + 백업**을 클릭합니다**.

1. **백업 목표** 블레이드에서 다음 설정을 지정합니다.

    | 설정 | 값 |
    | --- | --- |
    | 워크로드는 어디에서 실행되고 있습니까? | **Azure** (다른 옵션 확인) |
    | 백업하려는 것은 무엇입니까? | **가상 머신** (다른 옵션 확인 |

1. **백업 목표** 블레이드에서 **백업**을 클릭합니다.

1. **백업 정책**에서 **기본 정책** 설정을 검토하고 **새 정책 만들기**를 선택합니다.

1. 다음 설정을 사용하여 새 백업 정책을 지정합니다(다른 설정은 기본값으로 유지).

    | 설정 | 값 |
    | ---- | ---- |
    | 정책 이름 | `az104-policy` |
    | 빈도 | **매일** |
    | Time | **오전 12:00** |
    | 표준 시간대 | 현지 표준 시간대의 이름 |
    | 인스턴트 복구 스냅을 유지 | **2**일 |

    ![백업 정책 페이지의 스크린샷.](../media/az104-lab10-backup-policy.png)

1. **확인**을 클릭하여 정책을 만든 다음 **가상 머신** 섹션에서 **추가**를 선택합니다.

1. **가상 머신 선택** 블레이드에서 **az-104-10-vm0**을 선택하고 **확인**을 클릭한 후 **백업** 블레이드에서 **백업 사용**을 클릭합니다.

    >**참고**: 백업 사용 설정이 완료될 때까지 기다립니다. 이 작업은 약 2분 정도 걸립니다.

1. az104-vault1** Recovery Services 자격 증명 모음 블레이드**로 돌아가**서 보호된 항목** 섹션에서 백업 항목을** 클릭한 **다음 Azure 가상 머신** 항목을 클릭합니다**.

1. **백업 항목(Azure 가상 머신)** 블레이드에서 **az104-10-vm0**에 대한 **세부 정보 보기** 링크를 선택하고 **백업 사전 검사** 및 **마지막 백업 상태** 항목의 값을 검토합니다.

1. **az104-10-vm0** 백업 항목 블레이드에서 **지금 백업**을 클릭하고 드롭다운 목록까지 **백업 유지** 기본값을 수락하고 **확인**을 클릭합니다.

    >**참고**: 백업이 완료될 때까지 기다리지 말고 다음 작업으로 진행하세요.

## 작업 4: Azure Backup 모니터링

이 작업에서는 Azure Storage 계정을 배포합니다. 그런 다음 스토리지 계정에 로그 및 메트릭을 보내도록 자격 증명 모음을 구성합니다. 그런 다음 이 리포지토리를 Log Analytics 또는 기타 타사 모니터링 솔루션과 함께 사용할 수 있습니다.

1. Azure Portal에서 검색하여 선택합니다 `Storage accounts`.

1. Storage 계정 페이지에서 만들기**를 선택합니다**.

1. 다음 정보를 사용하여 스토리지 계정을 정의한 다음 검토를 선택합니다****.

    | 설정 | 값 |
    | --- | --- | 
    | 구독          | *구독*    |
    | 리소스 그룹        | **az104-rg10**        |
    | 스토리지 계정 이름  | 전역적으로 고유한 이름 제공(예 *: backupdiag1042024123)*    |
    | 지역                | **미국** 동부(또는 가까운 지역)    |

1. 검토 탭에서 만들기**를 선택합니다**.

    >**참고**: 배포가 완료될 때까지 기다립니다. 약 1분 정도 걸릴 수 있습니다.

1. **az104-vault1** Recovery Services 자격 증명 모음으로 이동합니다.

1. **az104-vault1** 페이지에서 진단 설정** 선택합니다**.

1. 진단 설정 페이지에서 진단 설정** 추가를 선택합니다**.

1. 진단 설정 페이지에서 설정 `Logs and Metrics to storage`이름을 지정합니다.

1. 다음 로그 및 메트릭 범주 옆에 검사mark를 배치합니다.

    - **Azure Backup 보고 데이터**
    - **Addon Azure Backup 작업 데이터**
    - **Addon Azure Backup 경고 데이터**
    - **Azure Site Recovery 작업**
    - **Azure Site Recovery 이벤트**
    - **상태**

1. 대상 세부 정보에서 스토리지 계정에 보관 옆에 **검사 표시를 배치합니다**.

1. Storage 계정 드롭다운 필드에서 이 작업의 앞부분에서 배포한 스토리지 계정을 선택합니다.

1. **저장**을 선택합니다.

1. **az104-vault1** 리소스 페이지로 돌아갑니다. 

1. az104-vault1**에서 **백업 작업을** 선택합니다**.

1. az104-10-vm0** VM에 대한 **백업 작업을 찾고 세부 정보를 선택합니다 **.**

    >**참고**: 화면 해상도에 따라 백업 작업 테이블에서 오른쪽으로 스크롤해야 할 수 있습니다.

1. VM에서 트리거한 백업 작업의 세부 정보를 검토합니다. 백업 작업의 두 하위 작업은 무엇인가요?


## 작업 5: Azure Site Recovery 구현

이 작업에서 다음을 수행합니다. 

1. Recovery Services 자격 증명 모음 az104-vault1**** 을 검색하여 선택합니다.

1. **개요** 블레이드에서 + Site Recovery** 사용을 선택합니다**.

1. 옵션을 검토한 다음, Azure Virtual Machines 섹션 복제본(replica)tion** 사용에서 선택합니다 **.****

1. 원본** 탭에서 **설정을 구성합니다.

    | 설정 | 값 |
    | ---- | ---- |
    | 지역| **미국** 동부(동일한 지역의 복제본(replica) 알림 읽기) |
    | Resource group | **az104-rg10** |
    | 가상 머신 배포 모델 | **Resource Manager** |
    | 가용성 영역 간의 재해 복구 | **문제** |

1. 다음을 선택하고 **가상 머신** 탭에서 **az104-10-vm0**을 선택합니다**.**

1. 다음**을 **선택하고 **복제 설정** 탭으로 이동합니다. 대상 위치 및 장애 조치(failover) 네트워크 정보를 확인합니다. 이러한 리소스는 자동으로 만들어집니다. 기본값을 사용하고 다음**을 선택합니다**.

1. 관리** 탭에서 **매개 변수를 검토합니다.

    | 설정 | 값 |
    | ---- | ---- |
    | 복제 정책 | **24시간 보존 정책** (0일에서 15일로 변경할 수 있습니다). |
    | 업데이트 설정 | **ASR이 관리하도록 허용** |

1. 다음**을 선택한 **다음 **, 복제본(replica)tion**을 사용하도록 설정합니다.

    >**참고**: 복제본(replica) 설정은 약 15분입니다. 포털의 오른쪽 위에 있는 알림 메시지를 확인합니다.

1. 복제본(replica) 작업이 완료되면 Recovery Services 자격 **증명 모음 az104-vault1**을 검색하여 찾습니다.

1. **보호된 항목** 섹션에서 복제된 항목을** 선택합니다**. 가상 머신이 복제본(replica) 상태에 대해 정상으로 표시되는지 확인합니다. 상태 상태 동기화(0%부터 시작)를 표시하고 초기 동기화가 완료된 후 보호됨**을 표시**합니다. 

    **알고 계셨나요?** 보호된 VM[의 장애 조치(failover)를 테스트하는 ](https://learn.microsoft.com/azure/site-recovery/tutorial-dr-drill-azure#run-a-test-failover-for-a-single-vm)것이 좋습니다.


## 랩의 기본 지점 검토

랩을 완료한 것을 축하합니다. 다음은 이 랩에 대한 기본 설명입니다. 

+ Azure Backup 서비스는 데이터를 백업하고 복구하는 간단하고 안전하며 비용 효율적인 솔루션을 제공합니다.

+ Azure Backup은 가상 머신 및 파일 공유를 포함하여 온-프레미스 및 클라우드 리소스를 보호할 수 있습니다.

+ Azure Backup 정책은 복구 지점의 백업 빈도 및 보존 기간을 구성합니다. 

+ Azure Site Recovery는 가상 머신 및 애플리케이션에 대한 보호를 제공하는 재해 복구 솔루션입니다.

+ Azure Site Recovery는 보조 사이트에 워크로드를 복제본(replica), 중단 또는 재해가 발생할 경우 보조 사이트로 장애 조치(failover)하고 가동 중지 시간을 최소화하면서 작업을 다시 시작할 수 있습니다.

+ Recovery Services 자격 증명 모음은 백업 데이터를 저장하고 관리 오버헤드를 최소화합니다.


## 리소스 정리

고유한 구독으로 작업하는 경우 랩 리소스를 삭제하는 데 1분이 소요됩니다. 이렇게 하면 리소스가 해제되고 비용이 최소화됩니다. 랩 리소스를 삭제하는 가장 쉬운 방법은 랩 리소스 그룹을 삭제하는 것입니다. 

+ Azure Portal에서 리소스 그룹을 선택하고, 리소스 그룹 삭제를 선택하고 **, **리소스 그룹** 이름을** 입력한 다음, 삭제**를 클릭합니다**.

+ Azure PowerShell 사용. `Remove-AzResourceGroup -Name resourceGroupName` 

+ CLI `az group delete --name resourceGroupName`를 사용하여 .


