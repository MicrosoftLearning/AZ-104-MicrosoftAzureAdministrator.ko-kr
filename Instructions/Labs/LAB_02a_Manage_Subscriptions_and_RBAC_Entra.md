---
lab:
  title: '랩 02a: 구독 및 RBAC 관리'
  module: Administer Governance and Compliance
---

# 랩 02a - 구독 및 RBAC 관리

## 랩 소개

이 랩에서는 역할 기반 액세스 제어에 대해 알아봅니다. 권한과 범위를 사용하여 ID가 수행할 수 있는 작업과 수행할 수 없는 작업을 제어하는 방법을 알아봅니다. 또한 관리 그룹을 사용하여 구독 관리를 더 쉽게 만드는 방법도 알아봅니다. 

이 랩을 수행하려면 Azure 구독이 필요합니다. 구독 유형은 이 랩의 기능 가용성에 영향을 미칠 수 있습니다. 지역을 변경할 수 있지만 단계는 **미국 동부**를 사용하여 작성됩니다. 

## 예상 소요 시간: 30분

## 랩 시나리오

조직의 Azure 리소스 관리를 간소화하기 위해 다음 기능을 구현해야 합니다.

- 모든 Azure 구독을 포함하는 관리 그룹을 만듭니다.

- 관리 그룹의 모든 구독에 대한 지원 요청을 제출할 수 있는 권한을 부여합니다. 권한은 다음으로만 제한되어야 합니다. 

    - 가상 머신 만들기 및 관리
    - 지원 요청 티켓 만들기(Azure 공급자 추가는 포함되지 않음)


## 대화형 랩 시뮬레이션

>**참고**: 이전에 제공되었던 랩 시뮬레이션은 사용 중지되었습니다.

## 아키텍처 다이어그램

![랩 작업 다이어그램.](../media/az104-lab02a-architecture.png)

## 작업 기술

+ 작업 1: 관리 그룹을 구현합니다.
+ 작업 2: 기본 제공 Azure 역할을 검토하고 할당합니다.
+ 작업 3: 사용자 지정 RBAC 역할을 만듭니다.
+ 작업 4: 활동 로그를 통해 역할 할당을 모니터링합니다.

## 작업 1: 관리 그룹 구현

이 작업에서는 관리 그룹을 만들고 구성합니다. 관리 그룹은 구독을 논리적으로 구성하고 분할하는 데 사용됩니다. 이를 통해 RBAC 및 Azure Policy를 다른 관리 그룹 및 구독에 할당하고 상속할 수 있습니다. 예를 들어, 조직에 유럽 전담 지원팀이 있는 경우 유럽 구독을 관리 그룹으로 구성하여 지원 담당자에게 해당 구독에 대한 액세스 권한을 제공할 수 있습니다(모든 구독에 대한 개별 액세스 권한을 제공하지 않음). 이 시나리오에서는 지원 센터의 모든 사람이 모든 구독에 대한 지원 요청을 만들어야 합니다. 

1. **Azure Portal** - `https://portal.azure.com`에 로그인합니다.

1. `Microsoft Entra ID`을 검색하고 선택합니다.

1. **관리** 블레이드에서 **속성**을 선택합니다.

1. **Azure 리소스에 대한 액세스 관리** 영역을 검토합니다. 테넌트의 모든 Azure 구독 및 관리 그룹에 대한 액세스를 관리할 수 있는지 확인합니다.
   
1. `Management groups`을 검색하고 선택합니다.

1. **관리 그룹** 블레이드에서 **+ 만들기**를 클릭합니다.

1. 다음 설정을 사용하여 새 관리 그룹을 만듭니다. 완료되면 **제출**을 선택합니다. 

    | 설정 | 값 |
    | --- | --- |
    | 관리 그룹 ID | `az104-mg1`(디렉터리에서 고유해야 함) |
    | 관리 그룹 표시 이름 | `az104-mg1` |

1. 새 관리 그룹이 표시되도록 관리 그룹 페이지를 **새로 고침**합니다. 1분 정도 걸릴 수 있습니다. 

   >**참고:** 루트 관리 그룹을 확인했나요? 이 루트 관리 그룹은 모든 관리 그룹과 구독이 루트 관리 그룹까지 접히도록 만들어집니다. 이 루트 관리 그룹은 글로벌 정책 및 Azure 역할 할당을 디렉터리 수준에서 적용하는 것을 허용합니다. 관리 그룹을 만든 후에는 그룹에 포함되어야 하는 모든 구독을 추가합니다. 

## 작업 2: 기본 제공 Azure 역할 검토 및 할당

이 작업에서는 기본 제공 역할을 검토하고 지원 센터 멤버에게 VM 기여자 역할을 할당합니다. Azure는 다양한 [기본 제공 역할](https://learn.microsoft.com/azure/role-based-access-control/built-in-roles)을 제공합니다. 

1. **az104-mg1** 관리 그룹을 선택합니다.

1. **액세스 제어(IAM)** 블레이드를 선택한 다음 **역할** 탭을 선택합니다.

1. 사용 가능한 기본 제공 역할 정의를 스크롤합니다. 역할을 **확인**하여 **권한**, **JSON** 및 **할당**에 대한 자세한 정보를 확인합니다. *소유자*, *기여자* 및 *읽기 권한자*를 자주 사용하게 됩니다. 

1. 드롭다운 메뉴에서 **+ 추가**를 선택하고 **역할 할당 추가**를 선택합니다. 

1. **역할 할당 추가** 블레이드에서 **가상 머신 기여자**를 검색하여 선택합니다. 가상 머신 Contributor 역할을 통해 가상 머신을 관리할 수 있지만, 운영 체제에 액세스하거나 연결된 가상 네트워크 및 스토리지 계정을 관리할 수는 없습니다. 이는 지원 센터의 좋은 역할입니다. **다음**을 선택합니다.

    >**유용한 정보** Azure에서는 원래 **클래식** 배포 모델만 제공했습니다. 이는 **Azure Resource Manager** 배포 모델로 바뀌었습니다. 클래식 리소스를 사용하지 않는 것이 가장 좋습니다. 

1. **멤버** 탭에서 **멤버 선택**을 클릭합니다.

    >**참고:** 다음 단계에서는 **기술 지원팀** 그룹에 역할을 할당합니다. 지원 센터 그룹이 없으면 그룹을 만들어 보세요.

1. `helpdesk` 그룹을 검색하고 선택합니다. **선택**을 클릭합니다. 

1. **검토 + 할당**을 두 번 클릭하여 역할 할당을 만듭니다.

1. **액세스 제어(IAM)** 블레이드를 계속 진행합니다. **역할 할당** 탭에서 **helpdesk** 그룹에 **가상 머신 기여자** 역할이 있는지 확인합니다. 

    >**참고:** 개인이 아닌 그룹에 역할을 할당하는 것이 가장 좋습니다. 

    >**유용한 정보** 이 할당은 실제로 추가 권한을 부여하지 않을 수도 있습니다. 소유자 역할이 이미 있는 경우 해당 역할에는 VM 기여자 역할과 관련된 모든 권한이 포함됩니다.
    
## 작업 3: 사용자 지정 RBAC 역할 만들기

이 작업에서는 사용자 지정 RBAC 역할을 만듭니다. 사용자 지정 역할은 환경에 대한 최소 권한 원칙을 구현하는 핵심 부분입니다. 기본 제공 역할에는 시나리오에 비해 너무 많은 권한이 있을 수 있습니다. 또한 새 역할을 만들고 필요하지 않은 권한을 제거합니다. 중복된 권한을 관리할 계획이 있나요?

1. 관리 그룹에 대한 작업을 계속합니다. **액세스 제어(IAM)** 블레이드로 이동합니다.

1. **+ 추가**를 선택하고 드롭다운 메뉴에서 **사용자 지정 역할 추가**를 선택합니다.

1. 기본 탭에서 구성을 완료합니다.

    | 설정 | 값 |
    | --- | --- |
    | 사용자 지정 역할 이름 | `Custom Support Request` |
    | 설명 | `A custom contributor role for support requests.` |

1. **기본 권한**에서 **역할 복제**를 선택합니다. **복제할 역할** 드롭다운 메뉴에서 **지원 요청 기여자**를 선택합니다.

    ![역할을 복제하는 스크린샷.](../media/az104-lab02a-clone-role.png)

1. **다음**을 선택하여 **권한** 탭으로 이동한 후 **+ 권한 제외**를 선택합니다.

1. 리소스 공급자 검색 필드에 `.Support`를 입력하고 **Microsoft.Support**를 선택합니다.

1. 권한 목록에서 **기타: 지원 리소스 공급자 등록** 옆에 있는 확인란을 선택한 다음 **추가**를 선택합니다. *NotAction*으로 이 권한을 포함하도록 역할을 업데이트해야 합니다.

    >**참고:** Azure 리소스 공급자는 특정 Azure 서비스에 대한 기능을 사용하도록 설정하는 REST 작업 집합입니다. 지원 센터에 이 기능이 있는 것을 원하지 않으므로 복제된 역할에서 제거됩니다. 

1. **할당 가능한 범위** 탭에서 관리 그룹이 나열되어 있는지 확인한 후 **다음**을 클릭합니다.

1. 역할에 사용자 지정된 *Actions*, *NotActions* 및 *AssignableScopes*에 대한 JSON을 검토합니다. 

1. **검토 + 만들기**를 선택한 후 **만들기**를 선택합니다.

    >**참고:** 이제 사용자 지정 역할을 만들어 관리 그룹에 할당했습니다.  

## 작업 4: 활동 로그를 사용하여 역할 할당 모니터링

이 작업에서는 활동 로그를 보고 누군가 새 역할을 만들었는지 확인합니다. 

1. 포털에서 **az104-mg1** 리소스를 찾아 **활동 로그**를 선택합니다. 활동 로그는 구독 수준 이벤트에 대한 인사이트를 제공합니다. 

1. 역할 할당에 대한 작업을 검토합니다. 특정 작업에 대해 활동 로그를 필터링할 수 있습니다. 

    ![구성된 필터가 포함된 활동 로그 페이지의 스크린샷.](../media/az104-lab02a-searchactivitylog.png)

## 리소스 정리

**고유의 구독**으로 작업하는 경우 랩 리소스를 삭제해 보세요. 이렇게 하면 리소스가 확보되고 비용이 최소화됩니다. 랩 리소스를 삭제하려면 랩 리소스 그룹을 삭제하는 것이 가장 쉽습니다. 

+ Azure Portal에서 리소스 그룹을 선택하고 **리소스 그룹 삭제**, **리소스 그룹 이름 입력**을 선택한 다음 **삭제**를 클릭합니다.
+ Azure PowerShell 사용, `Remove-AzResourceGroup -Name resourceGroupName`.
+ CLI 사용, `az group delete --name resourceGroupName`.
  
## Copilot을 사용하여 학습 확장

Copilot은 Azure 스크립팅 도구를 사용하는 방법을 익히는 데 도움을 줍니다. 또한 Copilot은 랩에서 다루지 않는 영역이나 추가 정보가 필요한 영역을 지원할 수 있습니다. Edge 브라우저를 열고 Copilot(오른쪽 위)을 선택하거나 *copilot.microsoft.com*으로 이동하세요. 몇 분 정도 시간을 내어 이러한 프롬프트를 사용해 보세요.
+ Azure의 조직 구독에 대한 정보를 가져오고 "설명" 열의 각 명령을 설명하기 위해 중요한 PowerShell 및 CLI 명령을 강조 표시하는 두 개의 테이블을 만듭니다. 
+ Azure RBAC JSON 파일의 형식은 무엇인가요?
+ 사용자 지정 Azure RBAC 역할을 만들기 위한 기본 단계는 무엇인가요?
+ Azure RBAC 역할과 Microsoft Entra ID 역할의 차이점은 무엇인가요?

## 자기 주도적 학습을 통해 자세히 알아보기

+ [Azure RBAC(Azure 역할 기반 액세스 제어)로 Azure 리소스를 보호합니다](https://learn.microsoft.com/training/modules/secure-azure-resources-with-rbac/). Azure RBAC를 사용하여 Azure의 리소스에 대한 액세스를 관리합니다.
+ [역할 기반 액세스 제어(RBAC)를 사용하여 Azure 리소스에 대한 사용자 지정 역할을 만듭니다](https://learn.microsoft.com/training/modules/create-custom-azure-roles-with-rbac/). 액세스 제어에 대한 역할 정의의 구조를 이해합니다. 사용자 지정 역할 권한을 정의하는 역할 속성을 식별합니다. Azure 사용자 지정 역할을 만들고 사용자에게 할당합니다.

## 핵심 내용

축하합니다. 랩을 완료했습니다. 이 랩의 주요 내용은 다음과 같습니다. 

+ 관리 그룹은 구독을 논리적으로 구성하는 데 사용됩니다.
+ 기본 제공 루트 관리 그룹에는 모든 관리 그룹 및 구독이 포함됩니다.
+ Azure에는 다양한 기본 제공 역할이 있습니다. 이러한 역할을 할당하여 리소스에 대한 액세스를 제어할 수 있습니다.
+ 새 역할을 만들거나 기존 역할을 사용자 지정할 수 있습니다.
+ 역할은 JSON 형식의 파일로 정의되며 *Actions*, *NotActions* 및 *AssignableScopes*를 포함합니다.
+ 활동 로그를 사용하여 역할 할당을 모니터링할 수 있습니다.




